#include <stdint.h>
#include <assert.h>

extern void mod_pow(uint16_t *out,
        uint16_t *workbuf32,
        const uint16_t * rr,
        uint16_t *in);

#define RSANUMWORDS 96 // 3072 = 192*16 bit

uint16_t n[RSANUMWORDS] = {
    0x75e1,
    0x6a6a,
    0xddc5,
    0xa018,
    0xb168,
    0x687b,
    0x05a5,
    0x8e82,
    0xffa7,
    0x7dbf,
    0x2ac5,
    0xc872,
    0x21cf,
    0xf84d,
    0x2531,
    0xe131,
    0xf8a3,
    0x0ce3,
    0xf988,
    0xa825,
    0x1964,
    0x57f5,
    0x206a,
    0xb27e,
    0xd008,
    0x8e1d,
    0xb8d7,
    0x1c4f,
    0xb142,
    0x824f,
    0xe7b3,
    0x1c8b,
    0x6366,
    0x7b9d,
    0xd0f2,
    0xc56a,
    0x2d5b,
    0xef76,
    0x31e3,
    0x4b14,
    0x8eb9,
    0x8ae2,
    0xb7aa,
    0xd41d,
    0xcdf7,
    0x43cc,
    0x4a84,
    0x91b7,
    0x3850,
    0x8018,
    0x4d0d,
    0x30e7,
    0xd015,
    0xb62e,
    0x74d2,
    0x2355,
    0xf251,
    0x8c28,
    0xdef2,
    0x4f40,
    0xefdb,
    0x24e2,
    0x1ff2,
    0x9ebd,
    0x49ee,
    0xfa7b,
    0xa938,
    0x2819,
    0xb8c8,
    0x6e66,
    0x1546,
    0x24e4,
    0x3a7c,
    0x4d78,
    0x7d3d,
    0xd294,
    0x69e9,
    0x1ab2,
    0x9f16,
    0xfad3,
    0x8f7b,
    0xaab7,
    0xb510,
    0x49d8,
    0x0dfb,
    0x35bf,
    0x4754,
    0xeb27,
    0xccc9,
    0x069e,
    0x437e,
    0xc13c,
    0x0f60,
    0xe3bc,
    0xe12f,
    0xc9e0};

uint16_t rr[RSANUMWORDS] = {
    0x77fa,
    0xa3eb,
    0xa2ac,
    0x9db9,
    0xd4ae,
    0x2c19,
    0xe1e7,
    0xfb5b,
    0xf5fb,
    0xdd38,
    0xfdda,
    0xd0f4,
    0x5cd3,
    0xeb16,
    0x7cfe,
    0x546a,
    0x0c5c,
    0xcd41,
    0xcf6b,
    0x73f5,
    0xbcae,
    0x1185,
    0x2103,
    0xda2e,
    0xae26,
    0xbab5,
    0x7aba,
    0x76e7,
    0xd5f7,
    0xf49d,
    0x8a29,
    0x3231,
    0x85bc,
    0x689a,
    0x62a9,
    0x8aa8,
    0x240e,
    0x538c,
    0xab77,
    0xb61e,
    0x73f2,
    0x9ccd,
    0xc81a,
    0x6563,
    0xac0e,
    0x6c65,
    0x09bf,
    0x90b2,
    0xe25e,
    0xe642,
    0x1549,
    0x7e35,
    0x1830,
    0x879a,
    0xbb02,
    0xc75c,
    0x2362,
    0xe011,
    0x405f,
    0xebc2,
    0x7990,
    0x01dc,
    0x07f3,
    0x3d3d,
    0xa5be,
    0xc5b9,
    0xcc33,
    0x98d8,
    0xe108,
    0xdd65,
    0x1343,
    0xce30,
    0xc0cb,
    0x0dbd,
    0xb9ca,
    0xc204,
    0x1810,
    0xeabe,
    0x163a,
    0x9849,
    0x8ff7,
    0x234c,
    0x4e3b,
    0x9bc1,
    0x2226,
    0x4b4c,
    0x83be,
    0x0798,
    0xc5f5,
    0xba59,
    0x7317,
    0xd9c7,
    0x89f5,
    0x1ce6,
    0x9af5,
    0x05f4};

const uint16_t d0inv = 0x71df;

/* Example signature created with example key above, no padding */
uint16_t sig[RSANUMWORDS] = {
  0xe983,  0xceb7,
  0xb200,  0xe693,
  0x3989,  0xf915,
  0x9599,  0xcf89,
  0x9fae,  0x1ec0,
  0x8007,  0xf2f8,
  0xeed5,  0x2a24,
  0x7c4e,  0x9c5b,
  0x53b2,  0x21a1,
  0x83ae,  0xaf75,
  0xd694,  0x04fd,
  0x094b,  0x7550,
  0x9ac4,  0xb2a6,
  0x8022,  0xe49d,
  0xf162,  0x7ed6,
  0x3a1b,  0x14bb,
  0xd8dd,  0xbb29,
  0x15c2,  0x5c58,
  0xd848,  0x7a80,
  0xf449,  0xb122,
  0xa808,  0x59dc,
  0x43e2,  0xbc14,
  0xff93,  0xe304,
  0x9953,  0x5867,
  0xa3a0,  0xe73d,
  0x1b9a,  0x4343,
  0x04d3,  0x699f,
  0xe066,  0xfc0b,
  0x06f2,  0xcce6,
  0xdfa0,  0xd94c,
  0xdca3,  0x6c1d,
  0x11f6,  0xe96c,
  0x5db4,  0xfc63,
  0x4f69,  0x3bdb,
  0xc3e7,  0xa621,
  0x2111,  0x9f29,
  0x1e6b,  0xb86e,
  0x923b,  0xb74f,
  0x67a0,  0x5929,
  0x097f,  0xc412,
  0xee4b,  0xcc97,
  0x6b57,  0x42ef,
  0x839f,  0x1436,
  0x0b45,  0xae86,
  0x3a17,  0x6a84,
  0xfb91,  0x2381,
  0x0635,  0x09fd};

int main(void) {
  uint16_t workbuf[2*RSANUMWORDS];
  uint16_t out[RSANUMWORDS];

  mod_pow(out,workbuf,rr,sig);
}

